/*
* ===========================
* Location    : /rscheck.js
* Machine     :
* Property of : RL OLC 36B
*
* Re-generated   : 0703-10 // ddmm-yy
* ===========================
*/
var http_req_rs=false,d=document;var section,rslinks,startFrm=0;var array_links=new Array();var arResp=new Array();function makePOSTReqRs(a,b){if(typeof XMLHttpRequest=='undefined'){objects=Array('Microsoft.XmlHttp','MSXML2.XmlHttp','MSXML2.XmlHttp.3.0','MSXML2.XmlHttp.4.0','MSXML2.XmlHttp.5.0');for(i=0;i<objects.length;i++){try{http_req_rs=new ActiveXObject(objects[i])}catch(e){}}}else{http_req_rs=new XMLHttpRequest()}if(!http_req_rs){alert('Cannot create XMLHTTP instance');return false}http_req_rs.open('POST',a,true);http_req_rs.setRequestHeader("Content-type","application/x-www-form-urlencoded");http_req_rs.setRequestHeader("Content-length",b.length);http_req_rs.setRequestHeader("Connection","close");http_req_rs.onreadystatechange=function(){handleResults(http_req_rs)};http_req_rs.send(b)}function handleResults(a){if(a.readyState==4){if(a.status==200){if(a.responseText=='url.blank'){d.body.innerHTML='Enter a valid URL'}else{var b=a.responseText,j=0,txrest;var c=unescape("%EF%BB%BF");rtime=getBetween(b,'<timerequire>','</timerequire>');b=getBetween(b,'<result>','</result>');b=b.replace(c,"");arResp=b.split("\n");if(undefined!=arResp){if(section=='audl'){for(var i=startFrm;i<array_links.length;i++){d.getElementById('status'+i).innerHTML=arResp[j];d.getElementById('statusTitle').innerHTML="&nbsp;<b><a href='javascript:void(0);' onclick='reLink(); loadHandler();'>Status</a></b>&nbsp;";j++}d.getElementById('btnaddlinks').disabled=false}else{txrest='<div id="listlink">';cntunknow=0;cntgood=0;linkonly=d.getElementById('d').checked;for(var i=startFrm;i<array_links.length;i++){good=(arResp[j].indexOf("good link")!=-1);if(good){cntgood++}unknow=(arResp[j].indexOf("unknown link")!=-1);if(unknow){cntunknow++}txrest+='<a class='+(good?'"g"':'"r"')+' href="'+array_links[i]+'" target="_blank">'+array_links[i]+'</a>'+(linkonly?'':'&nbsp;'+arResp[j])+'<br>\n';j++}txrest+='</div>';spc='&nbsp;';lnk='Link:&nbsp;';txrest+='<br><hr><center><small style="color:#fff"><b class="o">'+array_links.length+'</b> '+rtime+'<br>\n';txrest+='Dead&nbsp;'+lnk+'<b class="r">'+eval(array_links.length-cntgood-cntunknow)+'</b>\n';txrest+=spc+spc+'&#8212;'+spc+spc+'Good&nbsp;'+lnk+'<b class="g">'+eval(cntgood)+'</b>\n';txrest+=spc+spc+'&#8212;'+spc+spc+'Unknown&nbsp;'+lnk+'<b class="y">'+eval(cntunknow)+'</b></small></center>\n';d.getElementById('linkresult').innerHTML=txrest;disableIt(0)}if(section=='audl'){d.getElementById('btnaddlinks').disabled=false}else{disableIt(0)}}}}else{alert('There was a problem with the request.')}}}function chklinkOnly(a){var b='';try{d_target=d.getElementById('listlink');d_target=(d_target&&arResp.length)}catch(e){}if(d_target==null){return false}for(var i=0;i<array_links.length;i++){good=(arResp[i].indexOf("good link")!=-1);b+='<a class='+(good?'"g"':'"r"')+' href="'+array_links[i]+'" target="_blank">'+array_links[i]+'</a>'+(a?'':'&nbsp;'+arResp[i])+'<br>\n'}d.getElementById('listlink').innerHTML=b}function getBetween(a,b,c){var d=a.indexOf(b);var e=a.indexOf(c);var f=a.substring(eval(d+b.length),e);return f}function strrev(a){var b=a,reversed="";for(i=b.length;i>=0;i--){reversed=reversed+b.charAt(i)}hsl=encodeBase64(reversed);return hsl}function jlnkfilter(a){var b=a,charsuspect=new Array("*");var c="";srcL:for(var i=0;i<charsuspect.length;i++){if(b.indexOf(charsuspect[i])!=-1){b=b.replace(charsuspect[i],c);break srcL}}return b}function LnkChkHandler(a,b){var c=new RegExp('\r\n',"g");var d=new RegExp('\n',"g");var e=/((^http)*).\:\/\/.([a-zA-Z0-9\.])/;dlinks=a;dlinks=dlinks.replace(c,"\n");arlinks=dlinks.split(d);dlinks='';var f=(b>0?b:arlinks.length);for(i=0;i<f;i++){if(arlinks[i].substring(0,7)!='ht'+'tp://'){arlinks[i]='ht'+'tp://'+arlinks[i]}if(e.test(arlinks[i])){dlinks+=jlnkfilter(arlinks[i])+';'}}dlinks=dlinks.substring(0,dlinks.length-1);arlinks=dlinks.split(";");return arlinks}function disableIt(a){var b=new Array;var c=new Array(true,'redtxtareadisable',true,'');var e=new Array(false,'redtxtarea',false,'none');if(a==1){b=c}else{b=e}d.getElementById('links').readOnly=b[0];d.getElementById('links').className=b[1];d.getElementById('btnlnkchk').disabled=b[2];d.getElementById('lnkwait').style.display=b[3]}function checkLink(){var a=Array();disableIt(1);links=d.getElementById('links').value;a=LnkChkHandler(links);if(a.length!=0){getResults(dlinks,a,'index')}else{alert('Bad Link URL');disableIt(0)}}function getResults(a,b,c){var f='';section=c;try{f+=(d.getElementById('lcurl').checked==true?'|_curl=on;':'')}catch(e){}var g='&url='+f+'|_section='+section+';'+'|_url='+strrev(unescape(a));array_links=b;makePOSTReqRs('ajax_lnk.php',g)}